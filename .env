API_TOKEN=7542766614:AAHHD2bZZu4dMBsm55Nfq4T-y_IsJfeFTnY
ADMIN_IDS=5274097505,6364118939
GROUP_ID=-1002897201960
SMM_API_KEY=030721af5eaea75a86f77ebda0c74209
SMM_API_URL=https://easysmmpanel.com/api/v2
UPI_ID=kyakamhai@ybl
SUPPORT_USERNAME=@sastasmmhelper_bot


from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from asyncio import sleep

# Inline keyboard to redirect user to support bot
keyboard = InlineKeyboardMarkup(inline_keyboard=[
    [InlineKeyboardButton(text="🚀 Use Token in Support Bot", url="https://t.me/smmtokendesk_bot")]
])

# ✅ Function to send messages to user and admin/group
async def notify_user_and_admin(bot, user_id, amount, txn_id, token, group_id):
    # Notify the user
    try:
        await bot.send_message(
            chat_id=user_id,
            text=(
                "⚠️ <b>Payment Timeout</b>\n\n"
                f"🔐 <b>Token:</b> <code>{token}</code>\n"
                f"💸 <b>Amount:</b> ₹{amount}\n"
                f"📄 <b>Txn ID:</b> <code>{txn_id}</code>\n\n"
                "❗ Your payment was not approved in time.\n"
                "You can still use this token in our <b>Token Support Bot</b>."
            ),
            parse_mode="HTML",
            reply_markup=keyboard
        )
    except Exception as e:
        print(f"❌ Could not notify user {user_id}: {e}")

    # Notify the group or admin
    try:
        await bot.send_message(
            group_id,
            text=(
                f"📌 <b>Token generated due to delay</b>\n\n"
                f"👤 <b>User ID:</b> <code>{user_id}</code>\n"
                f"💰 <b>Amount:</b> ₹{amount}\n"
                f"🧾 <b>Txn ID:</b> <code>{txn_id}</code>\n"
                f"🔐 <b>Token:</b> <code>{token}</code>"
            ),
            parse_mode="HTML"
        )
    except Exception as e:
        print(f"❌ Could not notify admin/group: {e}")
        await sleep(1)
